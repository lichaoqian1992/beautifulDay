package com.manji.sheet.controller;

import org.apache.log4j.Logger;

import com.jfinal.core.Controller;
import com.jfinal.json.JFinalJson;
import com.jfinal.plugin.activerecord.Page;
import com.jfinal.plugin.activerecord.Record;
import com.manji.sheet.model.common.SheetResult;
import com.manji.sheet.model.enums.ResultEmuns;
import com.manji.sheet.service.BuyerPcService;
import com.manji.sheet.utils.DatesUtils;

public class BuyerPcController extends Controller{
	
	private static final Logger log = Logger.getLogger(BuyerPcController.class);
	
	private BuyerPcService service = new BuyerPcService();
	
	/*
	 * 客服系统 -建议
	 * */
	/**
	 * 我的建议
	 */
	@SuppressWarnings("static-access")
	public void mySuggest(){
		
		SheetResult result = new SheetResult();
		//获取参数
		String userId = getPara("user_id");
		String pageNum = getPara("page_num");
		String pageSize = getPara("page_size");
		String callBack = getPara("callback");
		//判断参数
		if(userId == null || userId.equals("")){
			result.setCode("403");
			result.setMessage("参数user_id不能为空！");
			renderText("返回消息："+JFinalJson.getJson().toJson(result).toString());
			return;
		}
		if(pageNum == null || pageNum.equals("")){
			result.setCode("403");
			result.setMessage("参数page_num不能为空！");
			renderText("返回消息："+JFinalJson.getJson().toJson(result).toString());
			return;
		}
		if(pageSize == null || pageSize.equals("")){
			result.setCode("403");
			result.setMessage("参数page_size不能为空！");
			renderText("返回消息："+JFinalJson.getJson().toJson(result).toString());
			return;
		}
		if(callBack == null || callBack.equals("")){
			result.setCode("403");
			result.setMessage("参数callback不能为空！");
			renderText("返回消息："+JFinalJson.getJson().toJson(result).toString());
			return;
		}
		log.info("=====调用mySuggest接口开始，调用开始时间："+new DatesUtils().time()+"参数值：userId="+userId+",pageNum="+pageNum+",pageSize="+pageSize+"=============");
		
		Page<Record> list = service.mySuggest(userId, pageNum, pageSize);
		
		if(list != null && list.getList().size() > 0){
			result.setCode("200");
			result.setMessage(ResultEmuns.getMessageByCode("200"));
			result.setResult(list);
		}else{
			result.setCode("404");
			result.setMessage(ResultEmuns.getMessageByCode("404"));
		}
		
		log.info("=====调用mySuggest接口结束，调用结束时间："+new DatesUtils().time()+"日志信息："+JFinalJson.getJson().toJson(result).toString()+"=============");

		renderText(callBack+"("+JFinalJson.getJson().toJson(result).toString()+")");
	}
	
	
	
	/*
	 * 客服系统 -交易纠纷
	 * */
	
	
	
	/*
	 * 客服系统 -举报
	 * */
	
}
