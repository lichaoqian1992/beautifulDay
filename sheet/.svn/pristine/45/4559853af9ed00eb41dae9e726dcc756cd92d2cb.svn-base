package com.manji.sheet.service;

import com.jfinal.plugin.activerecord.Db;
import com.jfinal.plugin.activerecord.Record;
import com.manji.sheet.utils.DatesUtils;
import com.manji.sheet.utils.WorkerNumberUtil;

import java.util.List;

/**
 * Created by pudding on 2017-6-19.(YYR 商家APP业务逻辑类)
 */
public class ShopAppService extends  BaseSheetService {

    //添加工单业务(发起举报)
    public int  saveSheets(String sheet_on,String status,String type_code,String sponsor_id,String sponsor,String sponsor_type,String sponsor_contoct,String source_code,String priority_level,String is_push)
    {
        return Db.update("insert into dt_sheets values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)",null,sheet_on,status,type_code,sponsor_id,priority_level,is_push
                ,sponsor,sponsor_type,sponsor_contoct,DatesUtils.time(),source_code);
    }

    //添加新增信息
    public int saveSheetInfo(String sheet_id,String descr,String pics,String submitter){
        return Db.update("insert into dt_sheet_info values(?,?,?,?,?,?)",null,sheet_id,descr,pics, DatesUtils.time(),submitter);
    }

    /**
     * 商家查询我被举报工单(我被举报)
     */
    public List<Record> findbusinessByShopId(String ShopUserId){
        List<Record> sheets=Db.find("select * from dt_sheets where id in (select sheet_id from dt_sheet_business where shop_user_id=?);",ShopUserId);
        return sheets;
    }

    /**
     * 通过工单发起人编号查询工单(我的举报)
     */
    public List<Record> findSheetBySponsorId(String sponsor_id){
        List<Record> recordList=Db.find("select * from dt_sheets where sponsor_id=?",sponsor_id);
        return  recordList;
    }

    /**
     * 通过工单id查询工单
     */
    public Record findSheetById(String sheetId){
        Record record=Db.findFirst("select * from dt_sheets where id=?",sheetId);
        return record;
    }

    /**
     * 通过工单号查询工单
     */
    public Record findSheetBySheetNo(String sheet_no){
        Record record=Db.findFirst("select * from dt_sheets where sheet_no=?",sheet_no);
        return record;
    }



    /**
     * 通过工单id查询新增详细信息
     * @return
     */
    public List<Record> findSheetInfo(String SheetId){
        List<Record> recordList= Db.find("select * from dt_sheet_info where sheet_id=?",SheetId);
        return  recordList;
    }

    /**
     * 获取商家全部二级分类
     * @return
     */
    public List<Record> getShopType(){
        //获取举报类型2级分类
        // (举报员工)
        List<Record> recordList= WorkerNumberUtil.getcodeReport("03");
        //（建议）
        List<Record> recordList1=WorkerNumberUtil.getcodeReport("05");
        //(评价纠纷)
        List<Record> recordList2=WorkerNumberUtil.getcodeReport("07");
        recordList.addAll(recordList1);
        recordList.addAll(recordList2);
        return recordList;
    }







}
