package com.manji.sheet.intercepter;

import com.jfinal.aop.Interceptor;
import com.jfinal.aop.Invocation;
import com.jfinal.core.Controller;
import com.manji.sheet.model.bean.Account;
import com.manji.sheet.utils.GetAccountUtils;

public class AppIntercepter implements Interceptor{

    @Override
    public void intercept(Invocation inv) {
        //获取当前控制器
        Controller controller = inv.getController();

                //先判断是否已经存入了
                Account sessAccount=controller.getSessionAttr("Account");//获取session里面的账户信息
                if (sessAccount==null){//还没有存放账户信息
                    String sessionid=controller.getPara("sessionId");
                    //获取用户信息
                    Account userinfo=GetAccountUtils.getAccount(sessionid);
                    if (userinfo.getUser_id().equals("")||userinfo.getUser_id()==null){
                        //没查到用户信息
                 controller.setSessionAttr("Account",null);
            }else{
                //将用户信息存入session
                controller.setSessionAttr("Account",userinfo);
            }
        }

    }



}
