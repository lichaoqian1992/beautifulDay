#@layout() 
#define main()

 <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>频道列表</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="/advert/toMain">主页</a>
                        </li>
                        <li>
                            <strong>频道列表</strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2">
    
                </div>
            </div>
            
            
            
            <div class="wrapper wrapper-content animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            
                            <div class="row adds-header ibox-content form-horizontal">
                                <div class="row adds-header form-horizontal">
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label">频道名称</label>
                                            <div class="col-sm-8">
                                                <input type="text" maxlength="10" name="" id="name" class="form-control" placeholder="请输入频道标题">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-3">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label">频道类型：</label>
                                            <div class="col-sm-8">
                                                 <select id="type" class="form-control">
								                   <option value="">不限</option>
								                   <option value="APP">APP</option>
								                   <option value="PC">PC</option>
								                 </select>
                                            </div>
                                        </div>
                                    </div>
                                     <div class="col-sm-3">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label">频道状态：</label>
                                            <div class="col-sm-8">
                                                <select id="state" class="form-control">
								                   <option value="">不限</option>
								                   <option value="0">关</option>
								                   <option value="1">开</option>
								                 </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-sm-2">
                                        <button type="button" id="searchPl" class="btn btn-primary pull-right" onclick="query('1')">查询</button>
                                        <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#newPlace">新增</button> -->
                                    </div>
                                </div>
                                
                                <table class="table table-striped table-bordered table-hover " >
                                    <thead>
                                        <tr>
                                            <th>编号</th>
                                            <th>名称</th>
                                            <th>标题</th>
                                            <th>序号</th>
                                            <th>端口</th>
                                            <th>层级</th>
                                            <th>状态</th>
                                            <th>展示开关</th>
                                            <th>跳转方式</th>
                                            <th>底部标识</th>
                                            <th>备注信息</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody id="placeList">
                                       
                                    </tbody>
                                </table>

                            </div>
                            <div class="row adds-header ibox-content form-horizontal">
                            	<div class="pull-left">
									<span id="pageInfo"></span>
									<input class="page_number" type="text" value="1" id="toPage" style="width:48px;height: 34px; text-align: center; border:1px solid #31AD8B; border-radius:4px;"/>&nbsp
									<button class="btn btn-primary pull-right" onclick="toPage()">GO</button>
								</div>	
								<div class="pull-right">
									<input id="firstPage" type="hidden"/>
									<input id="nowPage" type="hidden"/>
									<input id="lastPage" type="hidden"/>
									<a class="page_btn btn btn-primary" onclick="firstPage()">首页</a>
									<a class="page_btn btn btn-primary" onclick="upPage()">上一页</a>
									<a class="page_btn btn btn-primary" onclick="nextPage()">下一页</a>
									<a class="page_btn btn btn-primary" onclick="lastPage()">尾页</a>
								</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
	
			 <div class="modal inmodal" id="updatePlace" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content animated bounceInRight">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">关闭</span>
                            </button>
                            <h4 class="modal-title">修改频道</h4>
                        </div>
                        <div class="modal-body">
                            <form class="form-horizontal m-t" id="updateForm" novalidate="novalidate" method="POST" action="update">
                            	<div><input type="hidden" id="id"></div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">名称：</label>
                                    <div class="col-sm-8">
                                        <input id="chname" name="ch_name" class="form-control"  type="text" aria-required="true" aria-invalid="false">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">标题：</label>
                                    <div class="col-sm-8">
                                        <input id="title" name="ch_title" class="form-control" type="text" aria-required="true" aria-invalid="false">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">序号：</label>
                                    <div class="col-sm-8">
                                        <input id="sort" name="ch_sort" class="form-control" type="text" aria-required="true" aria-invalid="false">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">端口：</label>
                                    <div class="col-sm-8">
                                        <select id="port" name="port" class="form-control">
                                        	<option value="PC">PC</option>
                                        	<option value="APP">APP</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">层级：</label>
                                    <div class="col-sm-8">
                                        <input id="layer" name="ch_layer" class="form-control" type="text">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">状态：</label>
                                    <div class="col-sm-8">
                                        <select id="chstate" name="ch_state" class="form-control">
                                        	<option value="0">关</option>
                                        	<option value="1">开</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">展示开关：</label>
                                    <div class="col-sm-8">
                                        <select id="flag" name="ch_flag" class="form-control">
                                        	<option value="1">展示</option>
                                        	<option value="2">不展示</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">跳转方式：</label>
                                    <div class="col-sm-8">
                                        <select id="mode" name="ch_mode" class="form-control">
                                        	<option value="1">首页banner(水平自动滚动)</option>
                                        	<option value="2">首页banner(水平不自动滚动)</option>
                                        	<option value="3">上下自动滚动的广告</option>
                                        	<option value="4">上下不自动滚动的广告</option>
                                        	<option value="5">导航菜单</option>
                                        	<option value="6">平铺屏幕宽的广告</option>
                                        	<option value="7">平铺可超过屏幕宽的广告</option>
                                        	<option value="8">满集秒杀</option>
                                        	<option value="0">不显示</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">底部标识：</label>
                                    <div class="col-sm-8">
                                        <select id="foot"  class="form-control">
                                        	<option value="1">有</option>
                                        	<option value="2">无</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">备注信息：</label>
                                    <div class="col-sm-8">
                                        <input id="remark" name="ch_remark" class="form-control" type="text">
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                            <button type="submit" class="btn btn-primary" id="updateSubmit" data-dismiss="modal">保存</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <div class="pull-right">
                    By：<a href="javascript:void" target="_blank">manjiwang.com</a>
                </div>
                <div>
                    <strong>Copyright</strong> manjiwang.com &copy; 2016
                </div>
            </div>


    <!-- Mainly scripts -->
    <script src="#(ctx)/static/js/jquery-2.1.1.min.js"></script>
    <script src="#(ctx)/static/js/bootstrap.min.js"></script>
    <script src="#(ctx)/static/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <!-- Data Tables -->
    <script src="#(ctx)/static/js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="#(ctx)/static/js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <!-- Custom and plugin javascript -->
    <script src="#(ctx)/static/js/hplus.js?v=2.2.0"></script>
    <script src="#(ctx)/static/js/plugins/pace/pace.min.js"></script>
    <!-- layer javascript -->
    <script src="#(ctx)/static/js/plugins/layer/layer.min.js"></script>
		
  <script>
    $(document).ready(function () {
    	  
    	query(1);
    	
    	/* 弹出修改频道 */
    	
        $("#placeList").on('click',".updatebtn",function(){
            var id = Number($(this).parent().parent().find('td').first().text());
            $.ajax({
                type : "GET",
                url : "/advert/channel/change",
                dataType : "json",
                contentType : "application/json; charset=utf-8",
                data : {
                    "id": id
                },
                success : function(data) {
                	console.log(data);
                	if(data != null){
                		$("#id").val(data.id);
                		$("#chname").val(data.ch_name);
                		$("#title").val(data.ch_title);
                		$("#sort").val(data.ch_sort);
                		$("#port").val(data.port);
                		$("#layer").val(data.ch_layer);
                		$("#chstate").val(data.ch_state);
                		$("#flag").val(data.ch_flag);
                		$("#mode").val(data.ch_mode);
                		$("#foot").val(data.ch_foot);
                		$("#remark").val(data.ch_remark);
                	}
                },
                error: function(){
                	alert("数据异常");
                }
            });
        });
    	
     /**
      * 保存修改结果
      */
     
        
      $("#updateSubmit").click(function(){
        console.log($("#flag").val())
            $.ajax({
                type : "get",
                url : "/advert/channel/update",
                dataType : "json",
                contentType : "application/json; charset=utf-8",
                data : {
                    id: $("#id").val(),
                    name: $("#chname").val(),
                    title: $("#title").val(),
                    sort : $("#sort").val(),
                    port : $("#port").val(),
                    layer : $("#layer").val(),
                    state : $("#chstate").val(),
                    flag : $("#flag").val(),
                    mode : $("#mode").val(),
                    foot : $("#foot").val(),
                    remark : $("#remark").val()
                },
                success : function(data) {
                	console.info(data);
                	console.log("----");
                	if(data>0){
                		 location.reload();
                	}
                }
            });
            
        }); 
    	
      } )
      
      
      function query(page){
    	
    	if(page == undefined){
    		page = 1;
    	}
    	
    	var ajaxdatas ="page="+page;
    	
    	if($("#name").val() !=""&&$("#name").val()!=null){
    		ajaxdatas+="&title="+$("#name").val();
    	}
    	
    	if($("#type").val() !=""&&$("#type").val()!=null){
    		ajaxdatas+="&port="+$("#type").val();
    	}
    	
    	if($("#state").val() !=""&&$("#state").val()!=null){
    		ajaxdatas+="&state="+$("#state").val();
    	}
    	
    	
    	
    	
    	 $.ajax({
             type : "GET",
             url : "/advert/channel/query",
             dataType : "json",
             contentType : "application/json; charset=utf-8",
             data : ajaxdatas,
             success : function(data) {
                 console.log(data);
            	 if(data.code =="0000"){
            		 
            		 var index =data.data.pageNumber;
            		 var totalRow =data.data.totalRow;
            		 var totalPage =data.data.totalPage;
            		 var pageSize =data.data.pageSize;
            		 var list =data.data.list;
            		 
            		 var tablehtml="";
            		 $.each(list,function(i,item){
            			
            			 var id =item.id;
            			 var ch_name =item.ch_name;
            			 var ch_title =item.ch_title;
            			 var ch_remark =item.ch_remark;
            			 var ch_sort =item.ch_sort;
            			 var ch_port =item.port;
            			 var ch_flag =item.ch_flag;
            			 var ch_state =item.ch_state;
            			 var ch_mode =item.ch_mode;
            			 var ch_foot =item.ch_foot;
            			 var ch_layer =item.ch_layer;
            			 
            			 var stateStr = '';
            			 switch(ch_state){
	            			 case "0":
	            				 stateStr = '关';
	            				 break;
	            			 case "1":
	            				 stateStr = '开';
	            				 break;
            				 default:
            					 stateStr = '';
            			 }
            			 var flagStr = '';
            			 switch(ch_flag){
	            			 case "1":
	            				 flagStr = '展示';
	            				 break;
	            			 case "2":
	            				 flagStr = '不展示';
	            				 break;
            				 default:
            					 flagStr = '';
            			 }
            			 var modeStr = '';
            			 switch(ch_mode){
	            			 case "1":
	            				 modeStr = '首页banner（水平自动滚动）';
	            				 break;
	            			 case "2":
	            				 modeStr = '首页banner（水平不自动滚动）';
	            				 break;
	            			 case "3":
	            				 modeStr = '上下自动滚动的广告';
	            				 break;
	            			 case "4":
	            				 modeStr = '上下不自动滚动的广告';
	            				 break;
	            			 case "5":
	            				 modeStr = '导航菜单';
	            				 break;
	            			 case "6":
	            				 modeStr = '平铺屏幕宽的广告';
	            				 break;
	            			 case "7":
	            				 modeStr = '平铺可超过屏幕宽的广告';
	            				 break;
	            			 case "8":
	            				 modeStr = '满集秒杀';
	            				 break;
	            			 case "0":
	            				 modeStr = '不显示';
	            				 break;
            				 default:
            					 modeStr = '';
            			 }
            			 var footStr = '';
            			 switch(ch_foot){
	            			 case "1":
	            				 footStr = '有';
	            				 break;
	            			 case "2":
	            				 footStr = '无';
	            				 break;
            				 default:
            					 footStr = '';
            			 }
            			 
            			 var rowhtml ="<tr>"+
    					 "<td>"+id+"</td>"+
    					 "<td>"+ch_name+"</td>"+
    					 "<td>"+ch_title+"</td>"+
    					 "<td>"+ch_sort+"</td>"+
    					 "<td>"+ch_port+"</td>"+
    					 "<td>"+ch_layer+"</td>"+
    					 "<td>"+stateStr+"</td>"+
    					 "<td>"+flagStr+"</td>"+
    					 "<td>"+modeStr+"</td>"+
    					 "<td>"+footStr+"</td>"+
    					 "<td>"+ch_remark+"</td>"+
    					 "<td>"+"<button type='button' data-toggle='modal' data-target='#updatePlace' class='un-margin btn btn-xs btn-outline btn-info updatebtn'>修改</button>"+"</td>"+
    					 "</tr>";
    					
    					tablehtml+=rowhtml;
            			 
            		 })
            		 $("#placeList").html(tablehtml);
            		 $("#firstPage").val(1);
     				 $("#nowPage").val(data.data.pageNumber);
     				 $("#lastPage").val(data.data.totalPage);
     				 $("#pageInfo").html("共"+data.data.totalRow+"条数据，当前显示第 "+data.data.pageNumber+" 页  ，到");
            		 
            		 
            	 }else{
            		 layer.msg('查无数据！', {
         				icon: 1,
         				time: 1000
         			});
            	 }
             }
         });
    }
      
  //点击首页
	function firstPage(){
		if(1 == $("#nowPage").val()){
			layer.msg('已经是第一页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		query(1);
	}
	//点击上一页
	function upPage(){
		var page = $("#nowPage").val()*1-1;
		if(page<1){
			layer.msg('已经是第一页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		query(page);
	}
	//点击下一页
	function nextPage(){
		var page = $("#nowPage").val()*1+1;
		if(page>$("#lastPage").val()){
			layer.msg('已经是最后一页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		query(page);
	}
	//点击末页
	function lastPage(){
		var page = $("#lastPage").val();
		if(page == $("#nowPage").val()){
			layer.msg('已经是最后一页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		query(page);
	}
	//跳转到指定页
	function toPage(){   
		var page =parseInt($("#toPage").val().trim());

		if(page>$("#lastPage").val()){
			layer.msg('没有那么多页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		if(page<=0){
			layer.msg('页码不能小于1', {
				icon: 1,
				time: 1000
			});
			return;
		}
		if(page == $("#nowPage").val()){
			layer.msg('已经是第'+page+'页', {
				icon: 1,
				time: 1000
			});
			return;
		}
		query(page);
	}
    
  </script>



#end